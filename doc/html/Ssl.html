<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Ssl_threads.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Ssl_threads" rel="Chapter" href="Ssl_threads.html">
<link title="Ssl" rel="Chapter" href="Ssl.html"><link title="Exceptions and errors" rel="Section" href="#1_Exceptionsanderrors">
<link title="Communication" rel="Section" href="#1_Communication">
<link title="Threads" rel="Subsection" href="#2_Threads">
<link title="Threads" rel="Subsection" href="#2_Threads">
<link title="Contexts" rel="Subsection" href="#2_Contexts">
<link title="Ciphers" rel="Subsection" href="#2_Ciphers">
<link title="Certificates" rel="Subsection" href="#2_Certificates">
<link title="Creating, connecting and closing sockets" rel="Subsection" href="#2_Creatingconnectingandclosingsockets">
<link title="I/O on SSL sockets" rel="Subsection" href="#2_IOonSSLsockets">
<title>Ssl</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Ssl_threads.html" title="Ssl_threads">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Ssl.html">Ssl</a></h1>

<pre><span class="keyword">module</span> Ssl: <code class="code">sig</code> <a href="Ssl.html">..</a> <code class="code">end</code></pre><div class="info module top">
Functions for making encrypted communications using the Secure Socket Layer
    (SSL). These are mostly bindings to the openssl library.<br>
<b>Author(s):</b> Samuel Mimram<br>
</div>
<hr width="100%">
<br>
<h1 id="1_Exceptionsanderrors">Exceptions and errors</h1><br>

<pre><code><span id="TYPEssl_error"><span class="keyword">type</span> <code class="type"></code>ssl_error</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_none"><span class="constructor">Error_none</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
No error happened. This is never raised and should disappear in future
      versions.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_ssl"><span class="constructor">Error_ssl</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_want_read"><span class="constructor">Error_want_read</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The operation did not complete; the same TLS/SSL I/O function should be
      called again later.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_want_write"><span class="constructor">Error_want_write</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The operation did not complete; the same TLS/SSL I/O function should be
      called again later.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_want_x509_lookup"><span class="constructor">Error_want_x509_lookup</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The operation did not complete because an application callback set by
      <code class="code">set_client_cert_cb</code> has asked to be called again.  The TLS/SSL I/O function
      should be called again later. Details depend on the application.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_syscall"><span class="constructor">Error_syscall</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Some I/O error occurred.  The OpenSSL error queue may contain more
      information on the error.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_zero_return"><span class="constructor">Error_zero_return</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The TLS/SSL connection has been closed.  If the protocol version is SSL
      3.0 or TLS 1.0, this result code is returned only if a closure alert has
      occurred in the protocol, i.e. if the connection has been closed cleanly. Note
      that in this case <code class="code">Error_zero_return</code> does not necessarily indicate that the
      underlying transport has been closed.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_want_connect"><span class="constructor">Error_want_connect</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The operation did not complete; the same TLS/SSL I/O function should be
      called again later.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTssl_error.Error_want_accept"><span class="constructor">Error_want_accept</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The operation did not complete; the same TLS/SSL I/O function should be
      called again later.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
An ssl error has occured (see SSL_get_error(3ssl) for details).<br>
</div>


<pre><span id="TYPEbigarray"><span class="keyword">type</span> <code class="type"></code>bigarray</span> = <code class="type">(char, Bigarray.int8_unsigned_elt, Bigarray.c_layout) Bigarray.Array1.t</code> </pre>


<pre><span id="EXCEPTIONMethod_error"><span class="keyword">exception</span> Method_error</span></pre>
<div class="info ">
The SSL method could not be initalized.<br>
</div>

<pre><span id="EXCEPTIONContext_error"><span class="keyword">exception</span> Context_error</span></pre>

<pre><span id="EXCEPTIONCipher_error"><span class="keyword">exception</span> Cipher_error</span></pre>

<pre><span id="EXCEPTIONDiffie_hellman_error"><span class="keyword">exception</span> Diffie_hellman_error</span></pre>

<pre><span id="EXCEPTIONEc_curve_error"><span class="keyword">exception</span> Ec_curve_error</span></pre>

<pre><span id="EXCEPTIONCertificate_error"><span class="keyword">exception</span> Certificate_error</span></pre>
<div class="info ">
The SSL server certificate could not be initialized.<br>
</div>

<pre><span id="EXCEPTIONPrivate_key_error"><span class="keyword">exception</span> Private_key_error</span></pre>
<div class="info ">
The SSL server private key could not be intialized.<br>
</div>

<pre><span id="EXCEPTIONUnmatching_keys"><span class="keyword">exception</span> Unmatching_keys</span></pre>
<div class="info ">
The SSL private key does not match the certificate public key.<br>
</div>

<pre><span id="EXCEPTIONInvalid_socket"><span class="keyword">exception</span> Invalid_socket</span></pre>
<div class="info ">
The given socket is invalid.<br>
</div>

<pre><span id="EXCEPTIONHandler_error"><span class="keyword">exception</span> Handler_error</span></pre>
<div class="info ">
The SSL handler could not be initialized.<br>
</div>

<pre><span id="EXCEPTIONConnection_error"><span class="keyword">exception</span> Connection_error</span> <span class="keyword">of</span> <code class="type"><a href="Ssl.html#TYPEssl_error">ssl_error</a></code></pre>
<div class="info ">
The connection could not be made with the SSL service.<br>
</div>

<pre><span id="EXCEPTIONAccept_error"><span class="keyword">exception</span> Accept_error</span> <span class="keyword">of</span> <code class="type"><a href="Ssl.html#TYPEssl_error">ssl_error</a></code></pre>
<div class="info ">
Failed to accept an SSL connection.<br>
</div>

<pre><span id="EXCEPTIONRead_error"><span class="keyword">exception</span> Read_error</span> <span class="keyword">of</span> <code class="type"><a href="Ssl.html#TYPEssl_error">ssl_error</a></code></pre>
<div class="info ">
An error occured while reading data.<br>
</div>

<pre><span id="EXCEPTIONWrite_error"><span class="keyword">exception</span> Write_error</span> <span class="keyword">of</span> <code class="type"><a href="Ssl.html#TYPEssl_error">ssl_error</a></code></pre>
<div class="info ">
An error occured while writing data.<br>
</div>

<pre><code><span id="TYPEverify_error"><span class="keyword">type</span> <code class="type"></code>verify_error</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_get_issuer_cert"><span class="constructor">Error_v_unable_to_get_issuer_cert</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The issuer certificate could not be found: this occurs if the issuer
      certificate of an untrusted certificate cannot be found.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_get_ctl"><span class="constructor">Error_v_unable_to_get_ctl</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The CRL of a certificate could not be found.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_decrypt_cert_signature"><span class="constructor">Error_v_unable_to_decrypt_cert_signature</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate signature could not be decrypted. This means that the
      actual signature value could not be determined rather than it not matching the
      expected value, this is only meaningful for RSA keys.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_decrypt_CRL_signature"><span class="constructor">Error_v_unable_to_decrypt_CRL_signature</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The CRL signature could not be decrypted: this means that the actual
      signature value could not be determined rather than it not matching the
      expected value. Unused.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_decode_issuer_public_key"><span class="constructor">Error_v_unable_to_decode_issuer_public_key</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The public key in the certificate SubjectPublicKeyInfo could not be
      read.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_signature_failure"><span class="constructor">Error_v_cert_signature_failure</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The signature of the certificate is invalid.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_CRL_signature_failure"><span class="constructor">Error_v_CRL_signature_failure</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The signature of the certificate is invalid.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_not_yet_valid"><span class="constructor">Error_v_cert_not_yet_valid</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate is not yet valid: the notBefore date is after the current
      time.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_has_expired"><span class="constructor">Error_v_cert_has_expired</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate has expired: that is the notAfter date is before the
      current time.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_CRL_not_yet_valid"><span class="constructor">Error_v_CRL_not_yet_valid</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The CRL is not yet valid.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_CRL_has_expired"><span class="constructor">Error_v_CRL_has_expired</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The CRL has expired.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_error_in_cert_not_before_field"><span class="constructor">Error_v_error_in_cert_not_before_field</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate notBefore field contains an invalid time.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_error_in_cert_not_after_field"><span class="constructor">Error_v_error_in_cert_not_after_field</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate notAfter field contains an invalid time.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_error_in_CRL_last_update_field"><span class="constructor">Error_v_error_in_CRL_last_update_field</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The CRL lastUpdate field contains an invalid time.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_error_in_CRL_next_update_field"><span class="constructor">Error_v_error_in_CRL_next_update_field</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The CRL nextUpdate field contains an invalid time.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_out_of_mem"><span class="constructor">Error_v_out_of_mem</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
An error occurred trying to allocate memory. This should never happen.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_depth_zero_self_signed_cert"><span class="constructor">Error_v_depth_zero_self_signed_cert</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The passed certificate is self signed and the same certificate cannot be
      found in the list of trusted certificates.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_self_signed_cert_in_chain"><span class="constructor">Error_v_self_signed_cert_in_chain</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate chain could be built up using the untrusted certificates
      but the root could not be found locally.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_get_issuer_cert_locally"><span class="constructor">Error_v_unable_to_get_issuer_cert_locally</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The issuer certificate of a locally looked up certificate could not be
      found. This normally means the list of trusted certificates is not
      complete.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_unable_to_verify_leaf_signature"><span class="constructor">Error_v_unable_to_verify_leaf_signature</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
No signatures could be verified because the chain contains only one
      certificate and it is not self signed.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_chain_too_long"><span class="constructor">Error_v_cert_chain_too_long</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate chain length is greater than the supplied maximum
      depth. Unused.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_revoked"><span class="constructor">Error_v_cert_revoked</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The certificate has been revoked.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_invalid_CA"><span class="constructor">Error_v_invalid_CA</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
A CA certificate is invalid. Either it is not a CA or its extensions are
      not consistent with the supplied purpose.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_path_length_exceeded"><span class="constructor">Error_v_path_length_exceeded</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The basicConstraints pathlength parameter has been exceeded.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_invalid_purpose"><span class="constructor">Error_v_invalid_purpose</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The supplied certificate cannot be used for the specified purpose.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_untrusted"><span class="constructor">Error_v_cert_untrusted</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The root CA is not marked as trusted for the specified purpose.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_cert_rejected"><span class="constructor">Error_v_cert_rejected</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The root CA is marked to reject the specified purpose.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_subject_issuer_mismatch"><span class="constructor">Error_v_subject_issuer_mismatch</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The current candidate issuer certificate was rejected because its subject
      name did not match the issuer name of the current certificate.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_akid_skid_mismatch"><span class="constructor">Error_v_akid_skid_mismatch</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The current candidate issuer certificate was rejected because its subject
      key identifier was present and did not match the authority key identifier
      current certificate.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_akid_issuer_serial_mismatch"><span class="constructor">Error_v_akid_issuer_serial_mismatch</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The current candidate issuer certificate was rejected because its issuer
      name and serial number was present and did not match the authority key
      identifier of the current certificate.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_keyusage_no_certsign"><span class="constructor">Error_v_keyusage_no_certsign</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The current candidate issuer certificate was rejected because its keyUsage
      extension does not permit certificate signing.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_error.Error_v_application_verification"><span class="constructor">Error_v_application_verification</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
An application specific error. Unused.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Why did the certificate verification fail?<br>
</div>


<pre><span id="EXCEPTIONVerify_error"><span class="keyword">exception</span> Verify_error</span> <span class="keyword">of</span> <code class="type"><a href="Ssl.html#TYPEverify_error">verify_error</a></code></pre>
<div class="info ">
An error occured while verifying the certificate.<br>
</div>
<br>
<h1 id="1_Communication">Communication</h1><br>

<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">?thread_safe:bool -> unit -> unit</code></pre><div class="info ">
Initialize SSL functions. Should be called before calling any other
    function. The parameter <code class="code">thread_safe</code> should be set to true if you use
    threads in you application (the same effect can achived by calling
    <code class="code">Ssl_threads.init</code> first.<br>
</div>

<pre><span id="VALget_error_string"><span class="keyword">val</span> get_error_string</span> : <code class="type">unit -> string</code></pre><div class="info ">
Retrieve a human-readable message that corresponds to the last error that
    occurred.<br>
</div>

<pre><code><span id="TYPEprotocol"><span class="keyword">type</span> <code class="type"></code>protocol</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprotocol.SSLv23"><span class="constructor">SSLv23</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
accept all possible protocols (SSLv2 if supported by openssl,
               SSLv3, TLSv1, TLSv1.1 and TLSv1.2)<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprotocol.SSLv3"><span class="constructor">SSLv3</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
only SSL v3 protocol<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprotocol.TLSv1"><span class="constructor">TLSv1</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
only TLS v1 protocol<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprotocol.TLSv1_1"><span class="constructor">TLSv1_1</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
only TLS v1.1 protocol<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprotocol.TLSv1_2"><span class="constructor">TLSv1_2</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
only TLS v1.2 protocol<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Protocol used by SSL.<br>
</div>


<pre><span id="TYPEsocket"><span class="keyword">type</span> <code class="type"></code>socket</span> </pre>
<div class="info ">
An SSL abstract socket.<br>
</div>

<br>
<h2 id="2_Threads">Threads</h2><br>
<br>
<h2 id="2_Threads">Threads</h2><br>
<br>
You should not have to use those functions. They are only here for internal
    use (they are needed to make the openssl library thread-safe, see the
    <code class="code">Ssl_threads</code> module).<br>

<pre><span id="VALthread_safe"><span class="keyword">val</span> thread_safe</span> : <code class="type">bool Pervasives.ref</code></pre><br>
<h2 id="2_Contexts">Contexts</h2><br>

<pre><span id="TYPEcontext"><span class="keyword">type</span> <code class="type"></code>context</span> </pre>
<div class="info ">
A context. A context should be created by a server or client once per
    program life-time and holds mainly default values for the SSL structures
    which are later created for the connections.<br>
</div>


<pre><code><span id="TYPEcontext_type"><span class="keyword">type</span> <code class="type"></code>context_type</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTcontext_type.Client_context"><span class="constructor">Client_context</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Client connections.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTcontext_type.Server_context"><span class="constructor">Server_context</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Server connections.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTcontext_type.Both_context"><span class="constructor">Both_context</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Client and server connections.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Type of the context to create.<br>
</div>


<pre><span id="VALcreate_context"><span class="keyword">val</span> create_context</span> : <code class="type"><a href="Ssl.html#TYPEprotocol">protocol</a> -> <a href="Ssl.html#TYPEcontext_type">context_type</a> -> <a href="Ssl.html#TYPEcontext">context</a></code></pre><div class="info ">
Create a context.<br>
</div>

<pre><span id="VALuse_certificate"><span class="keyword">val</span> use_certificate</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> string -> string -> unit</code></pre><div class="info ">
<code class="code">use_certificate ctx cert privkey</code> makes the context <code class="code">ctx</code> use <code class="code">cert</code> as
 certificate's file name (in PEM format) and <code class="code">privkey</code> as private key file
 name.<br>
</div>

<pre><span id="VALset_password_callback"><span class="keyword">val</span> set_password_callback</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> (bool -> string) -> unit</code></pre><div class="info ">
Set the callback function called to get passwords for encrypted PEM files.
 The callback function takes a boolean argument which indicates if it's used
 for reading/decryption (<code class="code">false</code>) or writing/encryption (<code class="code">true</code>).<br>
</div>

<pre><span id="VALset_client_CA_list_from_file"><span class="keyword">val</span> set_client_CA_list_from_file</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> string -> unit</code></pre><div class="info ">
Set the list of CAs sent to the client when requesting a client certificate.<br>
</div>

<pre><code><span id="TYPEverify_mode"><span class="keyword">type</span> <code class="type"></code>verify_mode</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_mode.Verify_peer"><span class="constructor">Verify_peer</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_mode.Verify_fail_if_no_peer_cert"><span class="constructor">Verify_fail_if_no_peer_cert</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Implies <code class="code">Verify_peer</code>.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTverify_mode.Verify_client_once"><span class="constructor">Verify_client_once</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Implies <code class="code">Verify_peer</code>.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Verification modes (see SSL_CTX_set_verify(3)).<br>
</div>


<pre><span id="TYPEverify_callback"><span class="keyword">type</span> <code class="type"></code>verify_callback</span> </pre>
<div class="info ">
A callback function for verification. Warning: this might change in the future.<br>
</div>


<pre><span id="VALclient_verify_callback"><span class="keyword">val</span> client_verify_callback</span> : <code class="type"><a href="Ssl.html#TYPEverify_callback">verify_callback</a></code></pre><div class="info ">
Client's verification callback. Warning: this might change in the future.<br>
</div>

<pre><span id="VALset_client_verify_callback_verbose"><span class="keyword">val</span> set_client_verify_callback_verbose</span> : <code class="type">bool -> unit</code></pre><div class="info ">
Set verbosity of <a href="Ssl.html#VALclient_verify_callback"><code class="code">Ssl.client_verify_callback</code></a><br>
</div>

<pre><span id="VALset_verify"><span class="keyword">val</span> set_verify</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> <a href="Ssl.html#TYPEverify_mode">verify_mode</a> list -> <a href="Ssl.html#TYPEverify_callback">verify_callback</a> option -> unit</code></pre><div class="info ">
Set the verify mode and callback, see SSL_CTX_set_verify(3).
 Warning: this might change in the future.<br>
</div>

<pre><span id="VALset_verify_depth"><span class="keyword">val</span> set_verify_depth</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> int -> unit</code></pre><div class="info ">
Set the maximum depth for the certificate chain verification that shall be allowed.<br>
</div>
<br>
<h2 id="2_Ciphers">Ciphers</h2><br>

<pre><span id="TYPEcipher"><span class="keyword">type</span> <code class="type"></code>cipher</span> </pre>
<div class="info ">
A cipher. It holds the algorithm information for a particular cipher which
 are a core part of the SSL/TLS protocol.<br>
</div>


<pre><span id="VALdisable_protocols"><span class="keyword">val</span> disable_protocols</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> <a href="Ssl.html#TYPEprotocol">protocol</a> list -> unit</code></pre><div class="info ">
Disable all protocols from the list.
 Note that <code class="code">SSLv23</code> disables both SSLv2 and SSLv3 (as opposed to all the
 protocols).
<br>
</div>

<pre><span id="VALset_cipher_list"><span class="keyword">val</span> set_cipher_list</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> string -> unit</code></pre><div class="info ">
Set the list of available ciphers for a context. See man ciphers(1) for the format of the string.<br>
</div>

<pre><span id="VALhonor_cipher_order"><span class="keyword">val</span> honor_cipher_order</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> unit</code></pre><div class="info ">
When choosing a cipher, use the server's preferences instead of the client
 preferences. When not set, the SSL server will always follow the clients
 preferences. When set, the SSLv3/TLSv1 server will choose following its
 own preferences. Because of the different protocol, for SSLv2 the server
 will send its list of preferences to the client and the client chooses.<br>
</div>

<pre><span id="VALinit_dh_from_file"><span class="keyword">val</span> init_dh_from_file</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> string -> unit</code></pre><div class="info ">
Init DH parameters from file<br>
</div>

<pre><span id="VALinit_ec_from_named_curve"><span class="keyword">val</span> init_ec_from_named_curve</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> string -> unit</code></pre><div class="info ">
Init EC curve from curve name<br>
</div>

<pre><span id="VALget_cipher"><span class="keyword">val</span> get_cipher</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> <a href="Ssl.html#TYPEcipher">cipher</a></code></pre><div class="info ">
Get the cipher used by a socket.<br>
</div>

<pre><span id="VALget_cipher_description"><span class="keyword">val</span> get_cipher_description</span> : <code class="type"><a href="Ssl.html#TYPEcipher">cipher</a> -> string</code></pre><div class="info ">
Get a description of a cipher.<br>
</div>

<pre><span id="VALget_cipher_name"><span class="keyword">val</span> get_cipher_name</span> : <code class="type"><a href="Ssl.html#TYPEcipher">cipher</a> -> string</code></pre><div class="info ">
Get the name of a cipher.<br>
</div>

<pre><span id="VALget_cipher_version"><span class="keyword">val</span> get_cipher_version</span> : <code class="type"><a href="Ssl.html#TYPEcipher">cipher</a> -> string</code></pre><div class="info ">
Get the version of a cipher.<br>
</div>
<br>
<h2 id="2_Certificates">Certificates</h2><br>

<pre><span id="TYPEcertificate"><span class="keyword">type</span> <code class="type"></code>certificate</span> </pre>
<div class="info ">
A certificate.<br>
</div>


<pre><span id="VALread_certificate"><span class="keyword">val</span> read_certificate</span> : <code class="type">string -> <a href="Ssl.html#TYPEcertificate">certificate</a></code></pre><div class="info ">
<code class="code">read_certificate fname</code> reads the certificate in the file <code class="code">fname</code>.<br>
</div>

<pre><span id="VALwrite_certificate"><span class="keyword">val</span> write_certificate</span> : <code class="type">string -> <a href="Ssl.html#TYPEcertificate">certificate</a> -> unit</code></pre>
<pre><span id="VALget_certificate"><span class="keyword">val</span> get_certificate</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> <a href="Ssl.html#TYPEcertificate">certificate</a></code></pre><div class="info ">
Get the certificate used by a socket.<br>
</div>

<pre><span id="VALget_issuer"><span class="keyword">val</span> get_issuer</span> : <code class="type"><a href="Ssl.html#TYPEcertificate">certificate</a> -> string</code></pre><div class="info ">
Get the issuer of a certificate.<br>
</div>

<pre><span id="VALget_subject"><span class="keyword">val</span> get_subject</span> : <code class="type"><a href="Ssl.html#TYPEcertificate">certificate</a> -> string</code></pre><div class="info ">
Get the subject of a certificate.<br>
</div>

<pre><span id="VALload_verify_locations"><span class="keyword">val</span> load_verify_locations</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> string -> string -> unit</code></pre><div class="info ">
<code class="code">load_verify_locations ctxt cafile capath</code> specifies the locations for the
    context <code class="code">ctx</code>, at which CA certificates for verification purposes are
    located. <code class="code">cafile</code> should be the name of a CA certificates file in PEM format
    and <code class="code">capath</code> should be the name of a directory which contains CA certificates
    in PEM format. Empty strings can be used in order not to specify on of the
    parameters (but not both).<br>
<b>Raises</b> <code>Invalid_argument</code> if both strings are empty or if one of the files
    given in arguments could not be found.<br>
</div>

<pre><span id="VALget_verify_result"><span class="keyword">val</span> get_verify_result</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> int</code></pre><div class="info ">
Get the verification result.<br>
</div>
<br>
<h2 id="2_Creatingconnectingandclosingsockets">Creating, connecting and closing sockets</h2><br>

<pre><span id="VALembed_socket"><span class="keyword">val</span> embed_socket</span> : <code class="type">Unix.file_descr -> <a href="Ssl.html#TYPEcontext">context</a> -> <a href="Ssl.html#TYPEsocket">socket</a></code></pre><div class="info ">
Embed a Unix socket into an SSL socket.<br>
</div>

<pre><span id="VALopen_connection"><span class="keyword">val</span> open_connection</span> : <code class="type"><a href="Ssl.html#TYPEprotocol">protocol</a> -> Unix.sockaddr -> <a href="Ssl.html#TYPEsocket">socket</a></code></pre><div class="info ">
Open an SSL connection.<br>
</div>

<pre><span id="VALopen_connection_with_context"><span class="keyword">val</span> open_connection_with_context</span> : <code class="type"><a href="Ssl.html#TYPEcontext">context</a> -> Unix.sockaddr -> <a href="Ssl.html#TYPEsocket">socket</a></code></pre><div class="info ">
Open an SSL connection with the specified context.<br>
</div>

<pre><span id="VALshutdown_connection"><span class="keyword">val</span> shutdown_connection</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> unit</code></pre><div class="info ">
Close an SSL connection opened with <code class="code">open_connection</code>.<br>
</div>

<pre><span id="VALset_client_SNI_hostname"><span class="keyword">val</span> set_client_SNI_hostname</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> string -> unit</code></pre><div class="info ">
Set the hostname the client is attempting to connect to using the Server
 Name Indication (SNI) TLS extension.<br>
</div>

<pre><span id="VALconnect"><span class="keyword">val</span> connect</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> unit</code></pre><div class="info ">
Connect an SSL socket.<br>
</div>

<pre><span id="VALaccept"><span class="keyword">val</span> accept</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> unit</code></pre><div class="info ">
Accept an SSL connection.<br>
</div>

<pre><span id="VALflush"><span class="keyword">val</span> flush</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> unit</code></pre><div class="info ">
Flush an SSL connection.<br>
</div>

<pre><span id="VALshutdown"><span class="keyword">val</span> shutdown</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> unit</code></pre><div class="info ">
Close an SSL connection.<br>
</div>
<br>
<h2 id="2_IOonSSLsockets">I/O on SSL sockets</h2><br>

<pre><span id="VALverify"><span class="keyword">val</span> verify</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> unit</code></pre><div class="info ">
Check the result of the verification of the X509 certificate presented by
    the peer, if any. Raises a <code class="code">verify_error</code> on failure.<br>
</div>

<pre><span id="VALfile_descr_of_socket"><span class="keyword">val</span> file_descr_of_socket</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> Unix.file_descr</code></pre><div class="info ">
Get the file descriptor associated with a socket. It is primarly useful for
    <code class="code">select</code>ing on it; you should not write or read on it.<br>
</div>

<pre><span id="VALread"><span class="keyword">val</span> read</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> Bytes.t -> int -> int -> int</code></pre><div class="info ">
<code class="code">read sock buf off len</code> receives data from a connected SSL socket.<br>
</div>

<pre><span id="VALwrite"><span class="keyword">val</span> write</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> string -> int -> int -> int</code></pre><div class="info ">
<code class="code">write sock buf off len</code> sends data over a connected SSL socket.<br>
</div>

<pre><span id="VALread_into_bigarray"><span class="keyword">val</span> read_into_bigarray</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> <a href="Ssl.html#TYPEbigarray">bigarray</a> -> int -> int -> int</code></pre><div class="info ">
<code class="code">read_into_bigarray sock ba off len</code> receives data from a connected SSL socket.
    This function releases the runtime while the read takes place.<br>
</div>

<pre><span id="VALread_into_bigarray_blocking"><span class="keyword">val</span> read_into_bigarray_blocking</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> <a href="Ssl.html#TYPEbigarray">bigarray</a> -> int -> int -> int</code></pre><div class="info ">
<code class="code">read_into_bigarray_blocking sock ba off len</code> receives data from a
    connected SSL socket.
    This function DOES NOT release the runtime while the read takes place: it
    must be used with nonblocking sockets.<br>
</div>

<pre><span id="VALwrite"><span class="keyword">val</span> write</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> string -> int -> int -> int</code></pre><div class="info ">
<code class="code">write sock buf off len</code> sends data over a connected SSL socket.<br>
</div>

<pre><span id="VALwrite_bigarray"><span class="keyword">val</span> write_bigarray</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> <a href="Ssl.html#TYPEbigarray">bigarray</a> -> int -> int -> int</code></pre><div class="info ">
<code class="code">write_bigarray sock ba off len</code> sends data over a connected SSL socket.
    This function releases the runtime while the read takes place.<br>
</div>

<pre><span id="VALwrite_bigarray_blocking"><span class="keyword">val</span> write_bigarray_blocking</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> <a href="Ssl.html#TYPEbigarray">bigarray</a> -> int -> int -> int</code></pre><div class="info ">
<code class="code">write_bigarray sock ba off len</code> sends data over a connected SSL socket.
    This function DOES NOT release the runtime while the read takes place: it
    must be used with nonblocking sockets.<br>
</div>
<br>
<h3 id="3_Highlevelcommunicationfunctions">High-level communication functions</h3><br>

<pre><span id="VALinput_string"><span class="keyword">val</span> input_string</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> string</code></pre><div class="info ">
Input a string on an SSL socket.<br>
</div>

<pre><span id="VALoutput_string"><span class="keyword">val</span> output_string</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> string -> unit</code></pre><div class="info ">
Write a string on an SSL socket.<br>
</div>

<pre><span id="VALinput_char"><span class="keyword">val</span> input_char</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> char</code></pre><div class="info ">
Input a character on an SSL socket.<br>
</div>

<pre><span id="VALoutput_char"><span class="keyword">val</span> output_char</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> char -> unit</code></pre><div class="info ">
Write a char on an SSL socket.<br>
</div>

<pre><span id="VALinput_int"><span class="keyword">val</span> input_int</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> int</code></pre><div class="info ">
Input an integer on an SSL socket.<br>
</div>

<pre><span id="VALoutput_int"><span class="keyword">val</span> output_int</span> : <code class="type"><a href="Ssl.html#TYPEsocket">socket</a> -> int -> unit</code></pre><div class="info ">
Write an integer on an SSL socket.<br>
</div>
</body></html>